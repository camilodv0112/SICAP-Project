<UserControl x:Class="Presentacion.Views.CartasUserControlView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="720" d:DesignWidth="1000">
    
    <Grid Background="White" Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Header -->
            <RowDefinition Height="*"/>    <!-- Documents -->
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,30">
            <TextBlock Text="Cartas y Solicitudes" 
                       FontFamily="Verdana" 
                       FontSize="24" 
                       FontWeight="Bold" 
                       Foreground="#002898"/>
            <TextBlock Text="Documentos y cartas generadas por el sistema" 
                       FontFamily="Arial" 
                       FontSize="14" 
                       Foreground="#555555"
                       Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Document Cards -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <WrapPanel Orientation="Horizontal" HorizontalAlignment="Left">
                
                <!-- Card 1: Solicitud de Transporte -->
                <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" 
                        CornerRadius="8" Margin="10" Width="210" Height="280">
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="10" ShadowDepth="3"/>
                    </Border.Effect>
                    <Grid>
                        <Border Background="#002898" Height="40" VerticalAlignment="Top" CornerRadius="8,8,0,0">
                            <TextBlock Text="ðŸš—" FontSize="20" VerticalAlignment="Center" 
                                       HorizontalAlignment="Center" Foreground="White"/>
                        </Border>
                        <StackPanel Margin="15,50,15,15">
                            <TextBlock Text="Solicitud de Transporte" 
                                       FontFamily="Verdana" FontSize="13" FontWeight="Bold" 
                                       Foreground="#111111" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            <TextBlock Text="Para actividades y eventos" 
                                       FontFamily="Arial" FontSize="11" Foreground="#757575"
                                       TextWrapping="Wrap" Margin="0,0,0,15"/>
                            <Separator Background="#EEEEEE" Margin="0,10"/>
                            <Button Content="Generar Solicitud" Background="#002898" Foreground="White"
                                    FontFamily="Verdana" FontSize="12" Padding="10,5"
                                    BorderThickness="0" Cursor="Hand" Margin="0,10,0,0"
                                    Tag="SolicitudTransporte"
                                    Click="OpenDocumentPreview"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Card 2: JustificaciÃ³n de Estudiante -->
                <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" 
                        CornerRadius="8" Margin="10" Width="210" Height="280">
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="10" ShadowDepth="3"/>
                    </Border.Effect>
                    <Grid>
                        <Border Background="#204BB2" Height="40" VerticalAlignment="Top" CornerRadius="8,8,0,0">
                            <TextBlock Text="ðŸ“„" FontSize="20" VerticalAlignment="Center" 
                                       HorizontalAlignment="Center" Foreground="White"/>
                        </Border>
                        <StackPanel Margin="15,50,15,15">
                            <TextBlock Text="JustificaciÃ³n de Estudiante" 
                                       FontFamily="Verdana" FontSize="13" FontWeight="Bold" 
                                       Foreground="#111111" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            <TextBlock Text="Carta de justificaciÃ³n de inasistencia" 
                                       FontFamily="Arial" FontSize="11" Foreground="#757575"
                                       TextWrapping="Wrap" Margin="0,0,0,15"/>
                            <Separator Background="#EEEEEE" Margin="0,10"/>
                            <Button Content="Generar Carta" Background="#204BB2" Foreground="White"
                                    FontFamily="Verdana" FontSize="12" Padding="10,5"
                                    BorderThickness="0" Cursor="Hand" Margin="0,10,0,0"
                                    Tag="JustificacionEstudiante"
                                    Click="OpenDocumentPreview"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Card 3: Solicitud de Recursos/Refrigerios -->
                <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" 
                        CornerRadius="8" Margin="10" Width="210" Height="280">
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="10" ShadowDepth="3"/>
                    </Border.Effect>
                    <Grid>
                        <Border Background="#002898" Height="40" VerticalAlignment="Top" CornerRadius="8,8,0,0">
                            <TextBlock Text="ðŸ½ï¸" FontSize="20" VerticalAlignment="Center" 
                                       HorizontalAlignment="Center" Foreground="White"/>
                        </Border>
                        <StackPanel Margin="15,50,15,15">
                            <TextBlock Text="Solicitud de Recursos/Refrigerios" 
                                       FontFamily="Verdana" FontSize="13" FontWeight="Bold" 
                                       Foreground="#111111" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            <TextBlock Text="Para eventos y actividades" 
                                       FontFamily="Arial" FontSize="11" Foreground="#757575"
                                       TextWrapping="Wrap" Margin="0,0,0,15"/>
                            <Separator Background="#EEEEEE" Margin="0,10"/>
                            <Button Content="Generar Solicitud" Background="#002898" Foreground="White"
                                    FontFamily="Verdana" FontSize="12" Padding="10,5"
                                    BorderThickness="0" Cursor="Hand" Margin="0,10,0,0"
                                    Tag="SolicitudRecursos"
                                    Click="OpenDocumentPreview"
                            />
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Card 4: Solicitud de Espacios -->
                <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" 
                        CornerRadius="8" Margin="10" Width="210" Height="280">
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="10" ShadowDepth="3"/>
                    </Border.Effect>
                    <Grid>
                        <Border Background="#204BB2" Height="40" VerticalAlignment="Top" CornerRadius="8,8,0,0">
                            <TextBlock Text="ðŸ›ï¸" FontSize="20" VerticalAlignment="Center" 
                                       HorizontalAlignment="Center" Foreground="White"/>
                        </Border>
                        <StackPanel Margin="15,50,15,15">
                            <TextBlock Text="Solicitud de Espacios" 
                                       FontFamily="Verdana" FontSize="13" FontWeight="Bold" 
                                       Foreground="#111111" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            <TextBlock Text="Reserva de salas y espacios" 
                                       FontFamily="Arial" FontSize="11" Foreground="#757575"
                                       TextWrapping="Wrap" Margin="0,0,0,15"/>
                            <Separator Background="#EEEEEE" Margin="0,10"/>
                            <Button Content="Generar Solicitud" Background="#204BB2" Foreground="White"
                                    FontFamily="Verdana" FontSize="12" Padding="10,5"
                                    BorderThickness="0" Cursor="Hand" Margin="0,10,0,0"
                                    Tag="SolicitudEspacios"
                                    Click="OpenDocumentPreview"/>
                        </StackPanel>
                    </Grid>
                </Border>


            </WrapPanel>
        </ScrollViewer>

        <!-- Document Preview Overlay (existing overlay unchanged)-->
        <Border x:Name="DocumentPreviewOverlay" Background="#CC000000" Visibility="Collapsed" Grid.RowSpan="2">
            <Border Background="White"  CornerRadius="10" Padding="10">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" Opacity="0.3" BlurRadius="20" ShadowDepth="0"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <Grid Grid.Row="0" Margin="0,0,0,20">
                        <TextBlock Text="Vista Previa de Carta" FontFamily="Verdana" FontSize="20" 
                                   FontWeight="Bold" Foreground="#002898"/>
                        <Button Content="âœ•" HorizontalAlignment="Right" Background="Transparent"
                                BorderThickness="0" FontSize="20" Foreground="#555555"
                                Cursor="Hand" Click="CloseDocumentPreview"/>
                    </Grid>

                    <!-- Options - DinÃ¡mico segÃºn tipo de documento -->
                    <ScrollViewer Grid.Row="1" Margin="0,0,0,0" MaxHeight="150" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Formulario para Solicitud de Transporte -->
                            <StackPanel x:Name="FormularioTransporte" Visibility="Collapsed">
                                <TextBlock Text="Datos de la Solicitud de Transporte" FontFamily="Verdana" 
                                           FontSize="16" FontWeight="Bold" Foreground="#002898" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Fila 1 -->
                                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Nombre del solicitante:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=NombreSolicitante, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Dependencia:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DependenciaSolicitante, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 2 -->
                                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Responsable de la Actividad:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=ResponsableActividad, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="No. de pasajeros:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=NumeroPasajeros, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 3 - DescripciÃ³n (span 2 columns) -->
                                    <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,0,0,10">
                                        <TextBlock Text="DescripciÃ³n de la Actividad:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DescripcionActividad, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12" Height="50" TextWrapping="Wrap"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 4 - Destino -->
                                    <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,0,0,10">
                                        <TextBlock Text="Destino:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=Destino, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 5 -->
                                    <StackPanel Grid.Row="4" Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Departamento:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=Departamento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Row="4" Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Municipio:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=Municipio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 6 -->
                                    <StackPanel Grid.Row="5" Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Km aproximados:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=KmAproximados, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 7 - Salida -->
                                    <StackPanel Grid.Row="6" Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Fecha Salida (ej: 20/08/2025):" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=FechaSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Row="6" Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Hora Salida (ej: 7:00a.m):" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=HoraSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    
                                    <!-- Fila 8 - Regreso -->
                                    <StackPanel Grid.Row="7" Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Fecha Regreso:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=FechaRegreso, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Row="7" Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Hora Regreso:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=HoraRegreso, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                                
                                <Separator Background="#E0E0E0" Margin="0,10"/>
                                <TextBlock Text="InformaciÃ³n del VehÃ­culo (opcional)" FontWeight="Bold" 
                                           FontSize="13" Foreground="#666" Margin="0,10,0,10"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Tipo de VehÃ­culo:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=TipoVehiculo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="No. Placa:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=NumeroPlaca, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="4">
                                        <TextBlock Text="Color:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=ColorVehiculo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                            
                            <!-- Formulario para JustificaciÃ³n de Estudiante -->
                            <StackPanel x:Name="FormularioJustificacion" Visibility="Collapsed">
                                <TextBlock Text="Datos de JustificaciÃ³n de Estudiante" FontFamily="Verdana" 
                                           FontSize="16" FontWeight="Bold" Foreground="#002898" Margin="0,0,0,15"/>
                                
                                <!-- SecciÃ³n Destinatario -->
                                <TextBlock Text="Destinatario" FontWeight="Bold" FontSize="13" Foreground="#666" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Nombre completo:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DestinatarioNombre, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Cargo:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DestinatarioCargo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="InstituciÃ³n:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DestinatarioInstitucion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                                
                                <Separator Background="#E0E0E0" Margin="0,10"/>
                                
                                <!-- SecciÃ³n Evento -->
                                <TextBlock Text="InformaciÃ³n del Evento" FontWeight="Bold" FontSize="13" Foreground="#666" Margin="0,10,0,10"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Fecha (ej: 27 de marzo):" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=FechaEvento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Hora inicio:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=HoraInicio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="4" Margin="0,0,0,10">
                                        <TextBlock Text="Hora fin:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=HoraFin, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="Nombre del evento:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=NombreEvento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="Disciplina artÃ­stica:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DisciplinaEvento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                                
                                <Separator Background="#E0E0E0" Margin="0,10"/>
                                
                                <!-- SecciÃ³n Estudiante -->
                                <TextBlock Text="Datos del Estudiante" FontWeight="Bold" FontSize="13" Foreground="#666" Margin="0,10,0,10"/>
                                
                                <TextBlock Text="Seleccionar Estudiante:" FontSize="12" Foreground="#333" Margin="0,0,0,5"/>
                                <ComboBox FontFamily="Arial" FontSize="12" Padding="5"
                                          ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=Estudiantes}"
                                          SelectedItem="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=EstudianteSeleccionado, Mode=TwoWay}"
                                          DisplayMemberPath="DisplayText" Margin="0,0,0,10"/>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="Asignatura a justificar:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=AsignaturaEstudiante, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <!-- Formulario para Solicitud de Espacios/Recursos -->
                            <StackPanel x:Name="FormularioEspacios" Visibility="Collapsed">
                                <TextBlock Text="Datos de Solicitud" FontFamily="Verdana" 
                                           FontSize="16" FontWeight="Bold" Foreground="#002898" Margin="0,0,0,15"/>
                                
                                <!-- SecciÃ³n Destinatario -->
                                <TextBlock Text="Destinatario" FontWeight="Bold" FontSize="13" Foreground="#666" Margin="0,0,0,10"/>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="Nombre completo:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DestinatarioNombre, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="Cargo:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DestinatarioCargo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                                
                                <Separator Background="#E0E0E0" Margin="0,10"/>
                                
                                <!-- SecciÃ³n Actividad (para Refrigerios) -->
                                <TextBlock Text="Detalles de la Actividad" FontWeight="Bold" FontSize="13" Foreground="#666" Margin="0,10,0,10"/>
                                
                                <StackPanel Margin="0,0,0,10">
                                    <TextBlock Text="Nombre de la actividad:" FontSize="12" Foreground="#333"/>
                                    <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=NombreActividad, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                             Padding="5" FontSize="12"/>
                                </StackPanel>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="10"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,0,10">
                                        <TextBlock Text="Cantidad refrigerios:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=CantidadRefrigerios, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Margin="0,0,0,10">
                                        <TextBlock Text="Hora evento:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=HoraEvento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="4" Margin="0,0,0,10">
                                        <TextBlock Text="Fecha evento:" FontSize="12" Foreground="#333"/>
                                        <TextBox Text="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=FechaEvento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                 Padding="5" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                            
                            <!-- Formularios para otros tipos se agregarÃ¡n aquÃ­ -->
                        </StackPanel>
                    </ScrollViewer>

                    <!-- FlowDocument Viewer -->
                    <Border Grid.Row="2" BorderBrush="#E0E0E0" BorderThickness="1" 
                            Background="#FAFAFA" Padding="20">
                        <FlowDocumentScrollViewer x:Name="DocumentScrollViewer" />
                    </Border>

                    <!-- Actions -->
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                        <Button Content="ðŸ–¨ï¸ Imprimir" Background="#002898" Foreground="White"
                                FontFamily="Verdana" FontSize="14" Padding="15,10"
                                BorderThickness="0" Cursor="Hand" Margin="0,0,10,0" Click="PrintDocument"/>
                        <Button Content="Cerrar" Background="#757575" Foreground="White"
                                FontFamily="Verdana" FontSize="14" Padding="15,10"
                                BorderThickness="0" Cursor="Hand" Click="CloseDocumentPreview"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Border>
    </Grid>
</UserControl>
